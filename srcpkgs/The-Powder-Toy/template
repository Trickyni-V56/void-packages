# Template file for 'The-Powder-Toy'
pkgname=The-Powder-Toy
version=98.2.365
revision=1
build_style=meson
configure_args="-Dx86_sse=sse2
 -Dlua=$(vopt_if luajit luajit lua5.1)"
hostmakedepends="pkg-config"
makedepends="SDL2-devel fftw-devel zlib-devel libcurl-devel bzip2-devel
 libpng-devel jsoncpp-devel
 $(vopt_if luajit LuaJIT-devel lua51-devel)"
short_desc="Falling sand physics sandbox, simulates air pressure, velocity & heat"
maintainer="0x5c <dev@0x5c.io>"
license="GPL-3.0-or-later"
homepage="https://powdertoy.co.uk/"
distfiles="https://github.com/The-Powder-Toy/${pkgname}/archive/v${version}.tar.gz"
checksum=21900b6b022535d0e56126b023538cc4f44b64feceafb5640492618a42a60080

build_options="luajit"

if [ "$XBPS_WORDSIZE" = "$XBPS_TARGET_WORDSIZE" ] ; then
	build_options_default="luajit"
fi

do_install() {
	vbin build/powder
	vdoc README.md
	vinstall build/resources/powder.desktop 644 /usr/share/applications/
	for size in 16 32 48; do
		vinstall resources/generated_icons/icon_exe_${size}.png 644 /usr/share/icons/hicolor/${size}x${size}/apps powdertoy-powder.png
	done
}
